services:
  vuexy-full:
    image: nginx:alpine
    container_name: vuexy-full
    ports:
      - "8091:80"
    volumes:
      - ./full-version:/usr/share/nginx/html:ro
      - ./nginx-simple.conf:/etc/nginx/nginx.conf:ro
    networks:
      - vuexy-full-network
    healthcheck:
      test: ["CMD", "wget", "--quiet", "--tries=1", "--spider", "http://localhost"]
      interval: 30s
      timeout: 10s
      retries: 3

networks:
  vuexy-full-network:
    driver: bridge
# services:
#   # Load Balancer (HAProxy)
#   loadbalancer:
#     image: haproxy:2.8-alpine
#     container_name: vuexy-loadbalancer
#     ports:
#       - "8081:8080"  # HAProxy stats
#     volumes:
#       - ./haproxy.cfg:/usr/local/etc/haproxy/haproxy.cfg:ro
#     depends_on:
#       - vuexy-app-1
#       - vuexy-app-2
#       - vuexy-app-3
#     networks:
#       - vuexy-network
#     restart: unless-stopped
#     healthcheck:
#       test: ["CMD", "nc", "-z", "localhost", "80"]
#       interval: 30s
#       timeout: 10s
#       retries: 3

#   # Vuexy Application Instance 1
#   vuexy-app-1:
#     build:
#       context: .
#       dockerfile: Dockerfile
#     container_name: vuexy-app-1
#     ports:
#       - "80:80"
#     expose:
#       - "80"
#     networks:
#       - vuexy-network
#     restart: unless-stopped
#     environment:
#       - NODE_ENV=production
#       - INSTANCE_ID=1
#     healthcheck:
#       test: ["CMD", "curl", "-f", "http://localhost/health"]
#       interval: 30s
#       timeout: 10s
#       retries: 3
#       start_period: 40s

#   # Vuexy Application Instance 2
#   vuexy-app-2:
#     build:
#       context: .
#       dockerfile: Dockerfile
#     container_name: vuexy-app-2
#     expose:
#       - "80"
#     networks:
#       - vuexy-network
#     restart: unless-stopped
#     environment:
#       - NODE_ENV=production
#       - INSTANCE_ID=2
#     healthcheck:
#       test: ["CMD", "curl", "-f", "http://localhost/health"]
#       interval: 30s
#       timeout: 10s
#       retries: 3
#       start_period: 40s

#   # Vuexy Application Instance 3
#   vuexy-app-3:
#     build:
#       context: .
#       dockerfile: Dockerfile
#     container_name: vuexy-app-3
#     expose:
#       - "80"
#     networks:
#       - vuexy-network
#     restart: unless-stopped
#     environment:
#       - NODE_ENV=production
#       - INSTANCE_ID=3
#     healthcheck:
#       test: ["CMD", "curl", "-f", "http://localhost/health"]
#       interval: 30s
#       timeout: 10s
#       retries: 3
#       start_period: 40s

#   # Redis for session storage (optional)
#   redis:
#     image: redis:7-alpine
#     container_name: vuexy-redis
#     expose:
#       - "6379"
#     networks:
#       - vuexy-network
#     restart: unless-stopped
#     command: redis-server --appendonly yes
#     volumes:
#       - redis-data:/data
#     healthcheck:
#       test: ["CMD", "redis-cli", "ping"]
#       interval: 30s
#       timeout: 10s
#       retries: 3

#   # Monitoring with Prometheus (optional)
#   prometheus:
#     image: prom/prometheus:latest
#     container_name: vuexy-prometheus
#     ports:
#       - "9090:9090"
#     volumes:
#       - ./prometheus.yml:/etc/prometheus/prometheus.yml:ro
#       - prometheus-data:/prometheus
#     networks:
#       - vuexy-network
#     restart: unless-stopped
#     command:
#       - '--config.file=/etc/prometheus/prometheus.yml'
#       - '--storage.tsdb.path=/prometheus'
#       - '--web.console.libraries=/etc/prometheus/console_libraries'
#       - '--web.console.templates=/etc/prometheus/consoles'
#       - '--web.enable-lifecycle'

#   # Grafana for monitoring dashboard (optional)
#   grafana:
#     image: grafana/grafana:latest
#     container_name: vuexy-grafana
#     ports:
#       - "3000:3000"
#     environment:
#       - GF_SECURITY_ADMIN_PASSWORD=admin123
#     volumes:
#       - grafana-data:/var/lib/grafana
#     networks:
#       - vuexy-network
#     restart: unless-stopped

# networks:
#   vuexy-network:
#     driver: bridge
#     ipam:
#       config:
#         - subnet: 172.25.0.0/16

# volumes:
#   redis-data:
#     driver: local
#   prometheus-data:
#     driver: local
#   grafana-data:
#     driver: local